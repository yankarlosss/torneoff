<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados Torneo Free Fire</title>
    <link rel="stylesheet" href="style-results.css">
</head>
<body>


    <table id="results-table">
        <thead>
            <tr>
                <th>Posici√≥n</th>
                <th>Logo</th>
                <th>Equipo</th>
                <th>Kills</th>
                <th>Puntos</th>
            </tr>
        </thead>
        <tbody>
            <!-- Resultados se cargar√°n aqu√≠ -->
        </tbody>
    </table>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            updateResults();
        });

        function updateResults() {
            const teams = JSON.parse(localStorage.getItem('teams')) || [];
            const sortedTeams = teams.sort((a, b) => (b.points || 0) - (a.points || 0));
            const tbody = document.querySelector('#results-table tbody');

            const previousOrder = [...tbody.children].map(row => row.dataset.teamName);
            
            tbody.innerHTML = '';

            sortedTeams.forEach((team, index) => {
                const row = document.createElement('tr');
                row.dataset.teamName = team.name; // Guardar nombre del equipo en dataset

                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><img src="${team.logo}" alt="${team.name} Logo" class="team-logo"></td>
                    <td>${team.name}</td>
                    <td>${team.kills || 0}</td>
                    <td>${team.points || 0}</td>
                `;

                // Si la posici√≥n cambi√≥, a√±adir la animaci√≥n
                if (previousOrder.includes(team.name) && previousOrder.indexOf(team.name) !== index) {
                    row.classList.add('changed');
                    setTimeout(() => row.classList.remove('changed'), 1000); // Remover clase despu√©s de 1 seg
                }

                tbody.appendChild(row);
            });
        }

        // üî• Escuchar cambios en localStorage desde cualquier pesta√±a
        window.addEventListener('storage', (event) => {
            if (event.key === "teams") {
                updateResults();
            }
        });

        // ‚úÖ Alternativa: Disparador manual para forzar actualizaci√≥n
        function forceUpdate() {
            localStorage.setItem("updateTrigger", Date.now());
        }

        // üîÑ Escuchar el disparador para actualizar en cualquier pesta√±a
        window.addEventListener('storage', (event) => {
            if (event.key === "updateTrigger") {
                updateResults();
            }
        });

        // ‚è≥ Refresca cada 2 segundos como respaldo
        setInterval(updateResults, 2000);
    </script>

</body>
</html>
